<%- include('partials/header') %>

<section class="hero hero-wrapper overlay-jade hero-aesthetic"
         data-hero-bg='<%= (homepage && homepage.heroBg) || "https://images.pexels.com/photos/221457/pexels-photo-221457.jpeg" %>'>
  <div class="hero-overlay" aria-hidden="true"></div>

  <div class="content-wrapper container position-relative">
    <div class="row align-items-center justify-content-around">
      <div class="col-lg-9 col-md-10 col-sm-12 text-center">
        <div class="zip-code-search mb-5">
          <form role="search" aria-label="Find franchise by ZIP code" class="zip-card">
            <label for="zip-search-input" class="visually-hidden">ZIP Code</label>
            <div class="input-group input-group-lg">
              <span class="input-group-text bg-white border-0" aria-hidden="true">
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg" focusable="false" aria-hidden="true">
                  <path d="M19.3115 21.1768L19.4883 21.3535L19.665 21.1768L21.1768 19.6651L21.3536 19.4883L21.1768 19.3116L16.6315 14.7665C17.7498 13.2602 18.3556 11.4325 18.3559 9.55253V9.55249C18.3559 4.69878 14.4069 0.75 9.55295 0.75C4.69901 0.75 0.75 4.69878 0.75 9.55249C0.75 14.4062 4.69901 18.355 9.55295 18.355C11.4325 18.3548 13.26 17.7494 14.7661 16.6317L19.3115 21.1768ZM9.55295 3.38812C12.9526 3.38812 15.7177 6.15305 15.7177 9.55249C15.7177 12.9519 12.9526 15.7169 9.55295 15.7169C6.15329 15.7169 3.38824 12.9519 3.38824 9.55249C3.38824 6.15305 6.15329 3.38812 9.55295 3.38812Z" fill="#05132D" stroke="#05132D" stroke-width="0.5"></path>
                </svg>
              </span>
              <input
                type="text"
                id="zip-search-input"
                class="form-control border-0"
                placeholder="Enter ZIP code"
                inputmode="numeric"
                autocomplete="postal-code"
                pattern="[0-9]{5}"
                maxlength="5"
                aria-describedby="zip-search-help"
              />
              <button type="submit" class="btn btn-primary-dark px-4">Search</button>
            </div>
            <div id="zip-search-help" class="visually-hidden">Enter a 5-digit ZIP code to find your local franchise</div>
          </form>

          <div class="zip-code-results mt-3" aria-live="polite" aria-atomic="true"></div>
        </div>

        <h4 class="hero-eyebrow mb-2"><%= (homepage && homepage.heroSubtitle) || 'Pool Cleaning, Chemical Balancing, Equipment Service, and More' %></h4>
        <h1 class="hero-title mt-1 mb-0"><%= (homepage && homepage.heroTitle) || 'Your Trusted Pool Care Experts' %></h1>
      </div>
    </div>
  </div>
</section>

<!-- Page-scoped styles: Hero aesthetic -->
<style>
  .hero-aesthetic {
    position: relative;
    padding: clamp(5rem, 8vw, 9rem) 0 clamp(4rem, 6vw, 7rem) 0; /* extra top space to avoid crowding */
    color: #fff;
  }
  .hero-aesthetic .hero-overlay {
    position: absolute;
    inset: 0;
    background:
      linear-gradient(180deg, rgba(0, 0, 0, 0.55) 0%, rgba(0, 0, 0, 0.25) 40%, rgba(0, 0, 0, 0.55) 100%);
    pointer-events: none;
  }
  .hero-aesthetic .hero-eyebrow {
    letter-spacing: 0.08em;
    text-transform: uppercase;
    font-weight: 600;
    color: var(--brand-yellow, rgba(255, 255, 255, 0.9)) !important;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
  }
  .hero-aesthetic .hero-title {
    font-weight: 800;
    line-height: 1.1;
    font-size: clamp(2rem, 5vw, 3.25rem);
    text-shadow: 0 6px 22px rgba(0, 0, 0, 0.35);
    margin: 0;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
  }
  .hero-aesthetic .zip-card {
    margin-top: 1rem;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: saturate(140%) blur(8px);
    -webkit-backdrop-filter: saturate(140%) blur(8px);
    border-radius: 28px;
    padding: 0.9rem;
    box-shadow: 0 10px 26px rgba(0, 0, 0, 0.20), 0 2px 8px rgba(0, 0, 0, 0.10);
    border: 1px solid rgba(0, 0, 0, 0.06);
    width: min(100%, 620px);
    margin-left: auto;
    margin-right: auto;
    position: relative;
    z-index: 1;
    transition: box-shadow .2s ease, border-color .2s ease;
  }
  .hero-aesthetic .zip-card:focus-within {
    box-shadow: 0 0 0 3px var(--brand-red), 0 12px 30px rgba(0,0,0,.25);
    border-color: var(--brand-red);
  }
  .hero-aesthetic .hero-eyebrow {
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
  }
  .hero-aesthetic .zip-card .input-group-text {
    background: transparent !important;
    border: none !important;
    padding-left: .75rem;
    padding-right: .5rem;
  }
  .hero-aesthetic .zip-card .form-control {
    border: none !important;
    background: transparent !important;
    box-shadow: none !important;
    border-radius: 18px 0 0 18px;
    padding: .75rem .25rem;
    font-size: 1.05rem;
    color: #05132D;
  }
  .hero-aesthetic .zip-card .form-control::placeholder { color: rgba(5, 19, 45, 0.55); }
  .hero-aesthetic .zip-card .btn {
    border-radius: 18px;
    font-weight: 700;
    letter-spacing: 0.02em;
    box-shadow: 0 8px 18px rgba(0,0,0,.18);
    transition: transform .15s ease, box-shadow .15s ease;
  }
  .hero-aesthetic .zip-card .btn:hover { transform: translateY(-1px); box-shadow: 0 10px 22px rgba(0,0,0,.22); }
  /* Align button with site brand colors */
  .hero-aesthetic .btn.btn-primary-dark {
    background-color: var(--brand-red) !important;
    border-color: var(--brand-red) !important;
    color: #fff;
  }
  .hero-aesthetic .btn.btn-primary-dark:hover,
  .hero-aesthetic .btn.btn-primary-dark:focus {
    filter: brightness(1.05);
  }
  /* Modernized ZIP results card */
  .hero-aesthetic .zip-code-results {
    display: none;
    max-width: 620px;
    margin: 0.75rem auto 0 auto;
    background: rgba(255,255,255,0.95);
    border: 1px solid rgba(0,0,0,0.06);
    border-radius: 18px;
    padding: 0.75rem 1rem;
    box-shadow: 0 10px 24px rgba(0,0,0,0.12);
    color: #05132D;
  }
  .hero-aesthetic .zip-code-results.is-visible { display: block; }
  .hero-aesthetic .zip-code-results .result-item {
    display: flex; align-items: center; justify-content: space-between;
    gap: .75rem; padding: .6rem .25rem;
    border-bottom: 1px solid rgba(0,0,0,0.06);
  }
  .hero-aesthetic .zip-code-results .result-item:last-child { border-bottom: 0; }
  .hero-aesthetic .zip-code-results .result-title { font-weight: 800; }
  .hero-aesthetic .zip-code-results .result-meta { opacity: .7; }
  /* Ensure consistent spacing below the search card */
  .hero-aesthetic .zip-code-search { margin-bottom: 3.5rem !important; }
  @media (max-width: 576px) {
    .hero-aesthetic .zip-card { padding: 0.5rem; }
    .hero-aesthetic .zip-card .input-group.input-group-lg > .form-control,
    .hero-aesthetic .zip-card .input-group.input-group-lg > .input-group-text,
    .hero-aesthetic .zip-card .input-group.input-group-lg > .btn {
      font-size: 1rem;
      padding: 0.6rem 0.9rem;
    }
  }
</style>

<script>
  (function(){
    try {
      var scroller = document.querySelector('.scroller');
      if (!scroller) return;
      var inner = scroller.querySelector('.scroller__inner');
      if (!inner) return;
      if (inner.dataset.duplicated === 'true') return;
      // Duplicate children to enable seamless infinite scroll
      inner.innerHTML = inner.innerHTML + inner.innerHTML;
      inner.dataset.duplicated = 'true';
    } catch (e) { /* no-op */ }
  })();
</script>

<!-- Page-scoped styles: Blog, Warranty, Reviews, CTA modern refresh -->
<style>
  /* Blog Featured */
  .blogFeat { padding: 3rem 0 2rem; }
  .blogFeat .content-wrapper > h4 {
    letter-spacing: .12em; font-weight: 800; color: var(--brand-red); opacity: .9; margin-bottom: .25rem;
  }
  .blogFeat .content-wrapper > .section-title { margin-bottom: 1.5rem; }
  .featured-posts-wrapper { display: grid; gap: 1rem; grid-template-columns: repeat(12, 1fr); }
  /* Use existing bootstrap col classes as fallbacks; enhance with CSS grid spans */
  .featured-posts-wrapper > a.feat-post { grid-column: span 4; position: relative; border-radius: 16px; overflow: hidden; display: block; background: var(--brand-yellow); box-shadow: 0 14px 28px rgba(0,0,0,.16); transition: transform .18s ease, box-shadow .18s ease; }
  .featured-posts-wrapper > a.feat-post:hover { transform: translateY(-4px); box-shadow: 0 18px 36px rgba(0,0,0,.22); }
  .featured-posts-wrapper .post { height: 100%; display: grid; grid-template-rows: auto 1fr; }
  .featured-posts-wrapper .post-thumbnail { position: relative; aspect-ratio: 4/3; overflow: hidden; }
  .featured-posts-wrapper .post-thumbnail img { width: 100%; height: 100%; object-fit: cover; display: block; transform: scale(1.02); transition: transform .4s ease; }
  .featured-posts-wrapper a.feat-post:hover .post-thumbnail img { transform: scale(1.06); }
  .featured-posts-wrapper .entry-summary { position: relative; padding: 1rem; background: transparent; color: var(--brand-red); }
  .featured-posts-wrapper .entry-summary .entry-title { font-size: 1.05rem; line-height: 1.35; font-weight: 800; margin: 0 0 .35rem; }
  .featured-posts-wrapper .entry-summary p { margin: 0; opacity: .9; font-size: .95rem; max-height: 3.4em; overflow: hidden; }
  /* Split layout */
  .blog-split { display: grid; grid-template-columns: 1fr; gap: 1.25rem; align-items: start; }
  .blog-split.show-detail { grid-template-columns: 7fr 5fr; }
  .featured-post-detail[hidden] { display: none !important; }
  .featured-post-detail { min-height: 320px; display: block; }
  .featured-post-detail .detail-card { background: var(--brand-yellow); color: var(--brand-red); border-radius: 16px; overflow: hidden; box-shadow: 0 14px 28px rgba(0,0,0,.16); border: 1px solid rgba(0,0,0,0.06); position: sticky; top: 1rem; width: 100%; }
  .featured-post-detail .detail-thumb img { width: 100%; height: auto; display:   block; }
  .featured-post-detail .detail-body { padding: 1rem; }
  .featured-post-detail .detail-title { margin: 0 0 .5rem; font-weight: 900; }
  .featured-post-detail .detail-excerpt { margin: 0 0 .75rem; }
  .featured-post-detail .detail-actions .btn { border-radius: 999px; }
  /* Center the posts grid on the page */
  .featured-posts-wrapper { max-width: 980px; margin: 0 auto; }
  /* Active card outline */
  .featured-posts-wrapper a.feat-post.is-active { outline: 3px solid var(--brand-red); outline-offset: 2px; }
  @media (max-width: 991.98px) { .featured-posts-wrapper { grid-template-columns: repeat(6, 1fr); } .featured-posts-wrapper > a.feat-post { grid-column: span 6; } }
  @media (max-width: 768px) {
    .blog-split { grid-template-columns: 1fr; }
    .featured-post-detail { order: -1; }
    .featured-post-detail .detail-card { position: static; }
  }
  @media (max-width: 576px) { .featured-posts-wrapper { grid-template-columns: repeat(4, 1fr); gap: .75rem; } .featured-posts-wrapper > a.feat-post { grid-column: span 4; border-radius: 12px; } }

  /* Warranty Banner */
  .warranty.banner { position: relative; padding: 3.25rem 0; border-radius: 20px; overflow: hidden; margin: 2rem auto; }
  .warranty.banner::before { content: ""; position: absolute; inset: 0; background: radial-gradient(80% 60% at 50% 0%, rgba(255,255,255,.12), rgba(255,255,255,0)); opacity: .35; pointer-events: none; }
  .warranty .section-title { font-weight: 900; letter-spacing: .02em; text-transform: uppercase; }
  .warranty p { color: #fff; max-width: 900px; margin-left: auto; margin-right: auto; opacity: .95; }
  .warranty .section-title + p { margin-top: .5rem; }

  /* Reviews as scroll-snap cards */
  .resi-reviews--inner { display: flex; gap: 1rem; overflow-x: auto; scroll-snap-type: x mandatory; padding: .25rem 0 .5rem; }
  .resi-reviews--inner::-webkit-scrollbar { height: 8px; }
  .resi-reviews--inner::-webkit-scrollbar-thumb { background: rgba(0,0,0,.2); border-radius: 999px; }
  .resi-review { flex: 0 0 auto; min-width: 320px; max-width: 420px; scroll-snap-align: start; }
  .resi-review--inner { background: #ffffff; border-radius: 14px; box-shadow: 0 10px 22px rgba(0,0,0,.12); padding: 1rem; height: 100%; display: grid; grid-template-rows: auto 1fr auto; border: 1px solid rgba(0,0,0,.06); }
  .resi-review--stars { color: var(--brand-red); font-size: 1.05rem; letter-spacing: .06em; }
  .resi-review--content { color: #05132D; }
  .resi-review--author { font-weight: 800; margin: .5rem 0 0; color: #05132D; }
  @media (max-width: 576px) { .resi-review { min-width: 85%; } }

  /* Get Started CTA */
  .get-started { position: relative; border-radius: 20px; padding: 2rem 1.25rem; overflow: hidden; box-shadow: 0 18px 36px rgba(0,0,0,.14); }
  .get-started::before { content: ""; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,0)); pointer-events: none; }
  .get-started .estimate-prompt { text-align: center; }
  .get-started .section-title { color: #fff; font-weight: 900; }
  .get-started p { color: #fff; opacity: .95; }
  .get-started .btn-wrapper .btn { border-radius: 999px; padding: .75rem 1.25rem; font-weight: 800; }

  /* Clamp long text and add Read more button (on-brand) */
  .clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
  .clamp-4 { display: -webkit-box; -webkit-line-clamp: 4; line-clamp: 4; -webkit-box-orient: vertical; overflow: hidden; }
  .fade-after { position: relative; }
  .fade-after::after {
    content: ""; position: absolute; left: 0; right: 0; bottom: 0; height: 2.2em;
    background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,1));
    pointer-events: none;
  }
  /* Adjust fade to yellow cards inside blog */
  .featured-posts-wrapper a.feat-post .entry-summary.fade-after::after { background: linear-gradient(to bottom, rgba(255,255,255,0), var(--brand-yellow)); }
  .read-more-btn { background: none; border: none; color: var(--brand-red); font-weight: 800; padding: .25rem 0; cursor: pointer; }
  .read-more-btn:focus { outline: 3px solid var(--brand-red); outline-offset: 2px; }
</style>

<script>
  (function(){
    try {
      var results = document.querySelector('.zip-code-results');
      if (!results) return;
      var update = function(){
        var hasContent = (results.textContent || '').trim().length > 0 || results.children.length > 0;
        results.classList.toggle('is-visible', !!hasContent);
      };
      update();
      var mo = new MutationObserver(update);
      mo.observe(results, { childList: true, subtree: true, characterData: true });
    } catch(e) { /* no-op */ }
  })();
</script>

<script>
  // Add Read more / Show less toggles for long text in blog cards and reviews
  (function(){
    try {
      function clampify(containerSelector, paragraphSelector, clampClass, maxChars){
        var containers = document.querySelectorAll(containerSelector);
        containers.forEach(function(container){
          var ps = container.querySelectorAll(paragraphSelector);
          ps.forEach(function(p){
            // Skip if button already added
            if (p.dataset.processed === 'true') return;
            var text = (p.textContent || '').trim();
            if (text.length <= maxChars) { p.dataset.processed = 'true'; return; }
            p.classList.add(clampClass);
            // Add fade effect if parent allows background
            var parent = p.closest('.entry-summary') || p.parentElement;
            if (parent) parent.classList.add('fade-after');
            var btn = document.createElement('button');
            btn.type = 'button';
            btn.className = 'read-more-btn';
            btn.setAttribute('aria-expanded', 'false');
            btn.textContent = 'Read more';
            btn.addEventListener('click', function(){
              var expanded = btn.getAttribute('aria-expanded') === 'true';
              if (expanded) {
                p.classList.add(clampClass);
                if (parent) parent.classList.add('fade-after');
                btn.setAttribute('aria-expanded', 'false');
                btn.textContent = 'Read more';
              } else {
                p.classList.remove(clampClass);
                if (parent) parent.classList.remove('fade-after');
                btn.setAttribute('aria-expanded', 'true');
                btn.textContent = 'Show less';
              }
            });
            // Insert button after paragraph
            p.insertAdjacentElement('afterend', btn);
            p.dataset.processed = 'true';
          });
        });
      }
      // Blog cards: clamp to ~3 lines / ~160 chars
      clampify('.featured-posts-wrapper', '.entry-summary p', 'clamp-3', 160);
      // Reviews: clamp to ~4 lines / ~240 chars
      clampify('.resi-reviews--inner', '.resi-review--content p', 'clamp-4', 240);
    } catch(e) { /* no-op */ }
  })();
</script>

<div class="scroller-wrapper">
	<div class="content-wrapper">
		<div class="scroller" data-speed="fast" style="color: var(--brand-red)!important; background-color: var(--brand-yellow)!important;">
			<ul class="tag-list scroller__inner">
				<li>
					<div class="h1"><%= (homepage && homepage.scrollerText) || 'Cleaning, Balancing, Repairs, and more' %></div>
				</li>
			</ul>
		</div>
	</div>
</div>

<!-- Page-scoped styles: Scroller marquee (left-to-right) -->
<style>
  .scroller-wrapper { overflow: hidden; }
  .scroller {
    position: relative;
    overflow: hidden;
    white-space: nowrap;
    --scroll-duration: 20s;
  }
  .scroller[data-speed="slow"] { --scroll-duration: 28s; }
  .scroller[data-speed="normal"] { --scroll-duration: 20s; }
  .scroller[data-speed="fast"] { --scroll-duration: 12s; }
  .scroller__inner {
    display: inline-flex;
    align-items: center;
    gap: 2rem;
    animation: marquee-rtl-infinite var(--scroll-duration) linear infinite;
    animation-delay: calc(var(--scroll-duration) * -0.35);
    animation-fill-mode: both;
    will-change: transform;
    padding: 0.5rem 0;
  }
  .scroller:hover .scroller__inner { animation-play-state: paused; }
  .scroller .h1 { margin: 0; font-weight: 800; }
  /* With duplicated content, move by 50% for a seamless loop */
  @keyframes marquee-rtl-infinite {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  @media (prefers-reduced-motion: reduce) {
    .scroller__inner { animation: none; transform: none !important; }
  }
  /* Ensure the tag-list has no default margins/padding that could cause jumps */
  .scroller .tag-list { list-style: none; padding: 0; margin: 0; }
  .scroller .tag-list > li { display: inline-flex; }
</style>

<section class="who-we-are bg-primary bg-icon">
	<div class="content-wrapper container">
		<div class="row gap-4 gap-lg-0">
			<div class="col-sm-12 col-lg-6 text-center">
				<img width="750" height="600" src="<%= (homepage && homepage.whoWeAreImage) || 'https://i.pinimg.com/736x/ce/db/8e/cedb8ea3e7e0a515edf67cade4465d97.jpg' %>" class="img-fluid wp-image-29" alt="" decoding="async" fetchpriority="high" srcset="<%= (homepage && homepage.whoWeAreImage) || 'https://i.pinimg.com/736x/ce/db/8e/cedb8ea3e7e0a515edf67cade4465d97.jpg' %> 750w, <%= (homepage && homepage.whoWeAreImage) || 'https://i.pinimg.com/736x/ce/db/8e/cedb8ea3e7e0a515edf67cade4465d97.jpg' %> 300w" sizes="(max-width: 750px) 100vw, 750px" data-mwl-img-id="29" />
			</div>
			<div class="col-lg-1 d-none d-lg-block"></div>
			<div class="col-lg-5 col-sm-12">
				<h2 class="section-title" style="color: white;"><%= (homepage && homepage.whoWeAreTitle) || 'Who We Are' %></h2>
				<% if (homepage && homepage.whoWeAreBody) { %>
				  <% if (/<[a-z][\s\S]*>/i.test(homepage.whoWeAreBody)) { %>
				  <div class="who-we-are--copy"><%- homepage.whoWeAreBody %></div>
				  <% } else { %>
				  <% const __parts = (homepage.whoWeAreBody || '').trim().split(/\n\s*\n/); %>
				  <div class="who-we-are--copy">
				    <% __parts.forEach(function(p, idx){ %>
				      <% if (idx === __parts.length - 1) { %>
				        <h5><%= p.replace(/\n/g, ' ') %></h5>
				      <% } else { %>
				        <p><%= p.replace(/\n/g, ' ') %></p>
				      <% } %>
				    <% }) %>
				  </div>
				  <% } %>
				<% } else { %>
				  <div class="who-we-are--copy">
				    <p>At Swim Studs, we keep pools sparkling, safe, and swim‑ready all year long. From weekly cleaning to equipment repairs, our certified technicians deliver reliable pool care you can count on.</p><br />
				    <p>Our mission is to be the most trusted pool service in our communities—built on consistency, transparency, and great results.</p><br />
				    <p>Whether you need routine service, chemical balancing, filter and pump maintenance, green‑to‑clean recovery, or leak and equipment diagnostics, our team treats your pool like it’s our own.</p><br />
				    <h5 style="font-weight: bold;">Your pool should be effortless—let the Swim Studs handle the work while you enjoy the water.</h5>
				  </div>
				<% } %>
				<a href="<%= (homepage && homepage.ctaUrl) || '#' %>" class="btn btn-primary-dark mt-4" target=""><%= (homepage && homepage.ctaLabel) || 'Learn More' %></a>
			</div>
		</div>
	</div>
	<style>
	  /* Who We Are typography */
	  .who-we-are .who-we-are--copy p { margin-bottom: 1.2rem; font-weight: 400; line-height: 1.6; color: #fff; }
	  .who-we-are .who-we-are--copy h5 { font-weight: 700; margin-top: 1.5rem; color: #fff; font-size: 1.75rem; line-height: 1.3; }
	</style>

<style>
  /* Enlarge Quick Facts icons */
  .our-stats--stat--icon img {
    width: 80px !important;
    height: 80px !important;
    object-fit: contain;
    display: block;
    margin: 0 auto 8px;
  }
  @media (max-width: 576px) {
    .our-stats--stat--icon img { width: 72px !important; height: 72px !important; }
  }
</style>
</section>

<section class="our-services">
  	<div class="content-wrapper container">
  		<div class="row">
  			<div class="col-sm-12 text-center">
  				<h2 class="section-title" style="color: var(--brand-red) !important;"><%= (homepage && homepage.servicesTitle) || 'Our Services' %></h2>
  			</div>
  		</div>
  		<div class="row justify-content-around">
			<div class="col-sm-12">
				<div class="gy-4 text-center our-services--featured">
					<a class="service-card" href="<%= (homepage && homepage.featuredService1Url) || '/' %>" target=""><img width="800" height="642" src="<%= (homepage && homepage.featuredService1Image) || '/wp-content/uploads/2025/04/92a2b1320fd849d05eee3af9c8e41e87-e1750264298595-1024x822.jpg' %>" class="img-fluid wp-image-21" alt="" decoding="async" sizes="(max-width: 800px) 100vw, 800px" data-mwl-img-id="21" /><h3><%= (homepage && homepage.featuredService1Title) || 'Weekly Pool Cleaning' %></h3></a>
					<a class="service-card" href="<%= (homepage && homepage.featuredService2Url) || '/' %>" target=""><img width="800" height="640" src="<%= (homepage && homepage.featuredService2Image) || '/wp-content/uploads/2025/06/GU-website-photos-70-1024x819.png' %>" class="img-fluid wp-image-332" alt="" decoding="async" sizes="(max-width: 800px) 100vw, 800px" data-mwl-img-id="332" /><h3><%= (homepage && homepage.featuredService2Title) || 'Filter &amp; Pump Service' %></h3></a>
					<a class="service-card" href="<%= (homepage && homepage.featuredService3Url) || '/' %>" target=""><img width="800" height="640" src="<%= (homepage && homepage.featuredService3Image) || '/wp-content/uploads/2025/05/GU-website-photos-69-1024x819.png' %>" class="img-fluid wp-image-328" alt="" decoding="async" sizes="(max-width: 800px) 100vw, 800px" data-mwl-img-id="328" /><h3><%= (homepage && homepage.featuredService3Title) || 'Chemical Balancing' %></h3></a>
					<a class="service-card" href="<%= (homepage && homepage.featuredService4Url) || '/' %>" target=""><img width="800" height="640" src="<%= (homepage && homepage.featuredService4Image) || '/wp-content/uploads/2025/05/GU-website-photos-21-1024x819.png' %>" class="img-fluid wp-image-106" alt="" decoding="async" sizes="(max-width: 800px) 100vw, 800px" data-mwl-img-id="106" /><h3><%= (homepage && homepage.featuredService4Title) || 'Equipment Repairs' %></h3></a>
				</div>
				<div class="row mt-4 align-items-center our-services--services-cont">
					<div class="col-sm-10 text-center our-services--services">
						<% 
						  const pills = [];
						  for (let i = 1; i <= 6; i++) {
						    const label = homepage && homepage[`servicesBtn${i}Label`];
						    const url = homepage && homepage[`servicesBtn${i}Url`];
						    if (label && url) pills.push({ label, url });
						  }
						%>
						<% pills.forEach(function(p){ %>
					  <a href="<%= p.url %>" class="btn btn-ash "><%= p.label %></a>
					<% }) %>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<!-- Page-scoped styles: Our Services gallery art layout -->
<style>
  .our-services { padding: clamp(3rem, 6vw, 5rem) 0; }
  .our-services .section-title {
    font-size: clamp(1.8rem, 3.6vw, 2.6rem);
    letter-spacing: 0.01em;
    margin-bottom: 1.75rem;
  }

  /* Gallery grid */
  .our-services .our-services--featured {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    gap: clamp(14px, 2vw, 24px);
    text-align: left;
  }
  .our-services .our-services--featured .service-card {
    position: relative;
    display: block;
    border-radius: 18px;
    overflow: hidden;
    background: #000;
    box-shadow: 0 12px 30px rgba(0,0,0,.18);
    transform: translateZ(0);
  }
  .our-services .our-services--featured .service-card img {
    width: 100%; height: 100%; object-fit: cover; display: block;
    transition: transform .5s ease, filter .5s ease; filter: saturate(1.05);
  }
  .our-services .our-services--featured .service-card h3 {
    position: absolute; left: 16px; bottom: 14px; right: 16px;
    margin: 0; padding: .35rem .6rem; border-radius: 10px;
    background: linear-gradient(180deg, rgba(0,0,0,.0), rgba(0,0,0,.55));
    color: #fff; font-weight: 800; font-size: clamp(1rem, 1.6vw, 1.25rem);
    text-shadow: 0 6px 14px rgba(0,0,0,.45);
  }
  .our-services .our-services--featured .service-card::after {
    content: ""; position: absolute; inset: 0; pointer-events: none;
    background: linear-gradient(180deg, rgba(0,0,0,0) 40%, rgba(0,0,0,.35) 100%);
    transition: opacity .35s ease, background .35s ease; opacity: .85;
  }
  .our-services .our-services--featured .service-card:hover img { transform: scale(1.06); filter: saturate(1.15) contrast(1.05); }
  .our-services .our-services--featured .service-card:hover::after {
    /* Brand-red tint overlay on hover */
    background: linear-gradient(180deg, rgba(0,0,0,0) 25%, var(--brand-red) 100%);
    opacity: .55;
  }
  .our-services .our-services--featured .service-card:hover h3 {
    background: var(--brand-red);
  }

  /* Collage sizing (desktop) */
  .our-services .our-services--featured .service-card:nth-child(1) { grid-column: span 7; min-height: 360px; }
  .our-services .our-services--featured .service-card:nth-child(2) { grid-column: span 5; min-height: 360px; }
  .our-services .our-services--featured .service-card:nth-child(3) { grid-column: span 5; min-height: 300px; }
  .our-services .our-services--featured .service-card:nth-child(4) { grid-column: span 7; min-height: 300px; }

  /* Pills row improvements */
  .our-services .our-services--services { margin-top: .5rem; display: flex; flex-wrap: wrap; gap: .5rem .75rem; justify-content: center; }
  .our-services .btn.btn-ash {
    border-radius: 999px;
    padding: .55rem 1rem;
    background-color: var(--brand-red) !important;
    border-color: var(--brand-red) !important;
    color: #fff !important;
    font-weight: 600;
  }
  .our-services .btn.btn-ash:hover,
  .our-services .btn.btn-ash:focus {
    filter: brightness(1.05);
    color: #fff !important;
  }

  /* Responsive */
  @media (max-width: 991.98px) {
    .our-services .our-services--featured { grid-template-columns: repeat(6, 1fr); }
    .our-services .our-services--featured .service-card:nth-child(1),
    .our-services .our-services--featured .service-card:nth-child(2),
    .our-services .our-services--featured .service-card:nth-child(3),
    .our-services .our-services--featured .service-card:nth-child(4) { grid-column: span 6; min-height: 260px; }
  }
  @media (max-width: 576px) {
    .our-services { padding: 2.25rem 0; }
    .our-services .our-services--featured { gap: 12px; }
    .our-services .our-services--featured .service-card h3 { left: 12px; right: 12px; bottom: 10px; font-size: 1rem; }
    .our-services .our-services--services { gap: .5rem; }
  }
</style>

<!-- Page-scoped styles: Quick Facts brand color overrides -->
<style>
  /* Limit to Quick Facts section */
  .our-stats .our-stats--stat h3,
  .our-stats .our-stats--stat p {
    color: var(--brand-red) !important;
  }
  /* Recolor orange SVGs to brand red within Quick Facts only */
  .our-stats .our-stats--stat--icon img {
    filter: invert(18%) sepia(86%) saturate(4288%) hue-rotate(356deg) brightness(94%) contrast(102%);
  }
  /* Who We Are typography */
  .who-we-are .who-we-are--copy p { margin-bottom: 1.2rem; font-weight: 400; }
  .who-we-are .who-we-are--copy h5 { font-weight: 700; margin-top: 0.5rem; }
</style>

<section class="our-stats stripes-double-top bg-icon bg-icon--right col-sm-12 text-center">
	<div class="content-wrapper container">
		<div class="row">
			<div class="col-sm-12">
				<h2 class="section-title">Pool Facts</h2>
			</div>
		</div>
		<div class="stats-scroller" data-speed="normal">
			<div class="stats-scroller__inner our-stats--stats">
			<div class="our-stats--stat locations"><div class="our-stats--stat--icon"><img width="48" height="62" src="<%= (homepage && homepage.quickLocationsIcon) || '/wp-content/uploads/2025/04/icon-location.svg' %>" class="img-fluid" alt="" decoding="async" /></div><h3 class="gradient"><%= (homepage && homepage.quickLocations) || '1' %></h3><p><%= (homepage && homepage.quickLocationsLabel) || 'LOCATIONS' %></p></div>
			<div class="our-stats--stat jobs-completed"><div class="our-stats--stat--icon"><img width="67" height="62" src="<%= (homepage && homepage.quickJobsIcon) || '/wp-content/uploads/2025/04/icon-jobs.svg' %>" class="img-fluid" alt="" decoding="async" /></div><h3 class="gradient"><%= (homepage && homepage.quickJobs) || '100' %></h3><p><%= (homepage && homepage.quickJobsLabel) || 'JOBS COMPLETED' %></p></div>
			<div class="our-stats--stat states-were-in"><div class="our-stats--stat--icon"><img width="72" height="68" src="<%= (homepage && homepage.quickStatesIcon) || '/wp-content/uploads/2025/04/icon-texas.svg' %>" class="img-fluid" alt="" decoding="async" /></div><h3 class="gradient"><%= (homepage && homepage.quickStates) || '1' %></h3><p><%= (homepage && homepage.quickStatesLabel) || "STATES WE'RE IN" %></p></div>
			<div class="our-stats--stat 5-star-reviews"><div class="our-stats--stat--icon"><img width="213" height="35" src="<%= (homepage && homepage.quickReviewsIcon) || '/wp-content/uploads/2025/04/icon-stars.svg' %>" class="img-fluid" alt="" decoding="async" /></div><h3 class="gradient"><%= (homepage && homepage.quickReviews) || '50' %></h3><p><%= (homepage && homepage.quickReviewsLabel) || '5 STAR REVIEWS' %></p></div>
			<div class="our-stats--stat possibilities"><div class="our-stats--stat--icon"><img width="67" height="65" src="<%= (homepage && homepage.quickEstimatesIcon) || '/wp-content/uploads/2025/04/icon-availability.svg' %>" class="img-fluid" alt="" decoding="async" /></div><h3 class="gradient"><%= (homepage && homepage.quickEstimates) || '24/7' %></h3><p><%= (homepage && homepage.quickEstimatesLabel) || 'ESTIMATES AVAILABLE' %></p></div>
			<div class="our-stats--stat possibilities"><div class="our-stats--stat--icon"><img width="72" height="72" src="<%= (homepage && homepage.quickPossibilitiesIcon) || '/wp-content/uploads/2025/04/icon-check-badge.svg' %>" class="img-fluid" alt="" decoding="async" /></div><h3 class="gradient"><%= (homepage && homepage.quickPossibilities) || 'ENDLESS' %></h3><p><%= (homepage && homepage.quickPossibilitiesLabel) || 'POSSIBILITIES' %></p></div>
			</div>
		</div>
	</div>
</section>

<!-- Page-scoped styles: Pool Facts infinite marquee -->
<style>
  .our-stats .stats-scroller {
    overflow: hidden;
    position: relative;
    --stats-duration: 24s;
  }
  .our-stats .stats-scroller[data-speed="slow"] { --stats-duration: 32s; }
  .our-stats .stats-scroller[data-speed="normal"] { --stats-duration: 24s; }
  .our-stats .stats-scroller[data-speed="fast"] { --stats-duration: 16s; }

  .our-stats .stats-scroller__inner {
    display: flex;
    flex-wrap: nowrap;
    align-items: stretch;
    gap: 2.5rem;
    white-space: nowrap;
    animation: stats-marquee-rtl var(--stats-duration) linear infinite;
    animation-delay: calc(var(--stats-duration) * -0.35);
    will-change: transform;
  }
  .our-stats .stats-scroller:hover .stats-scroller__inner { animation-play-state: paused; }

  /* Ensure each stat lays out horizontally without wrapping weird bootstrap row margins */
  .our-stats .our-stats--stats { margin-left: 0; margin-right: 0; }
  .our-stats .our-stats--stat { display: inline-flex; flex-direction: column; align-items: center; padding: 0 0.25rem; flex: 0 0 auto; }

  /* Seamless loop: translate by half after duplication */
  @keyframes stats-marquee-rtl {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }

  @media (prefers-reduced-motion: reduce) {
    .our-stats .stats-scroller__inner { animation: none; transform: none !important; }
  }
</style>

<script>
  (function(){
    try {
      var wrap = document.querySelector('.our-stats .stats-scroller');
      if (!wrap) return;
      var inner = wrap.querySelector('.stats-scroller__inner');
      if (!inner) return;
      if (inner.dataset.duplicated === 'true') return;
      inner.innerHTML = inner.innerHTML + inner.innerHTML;
      inner.dataset.duplicated = 'true';
    } catch (e) { /* no-op */ }
  })();
</script>

<section class="blogFeat blogFeat-wrapper col-sm-12">
	<div class="content-wrapper container">
		<h4><%= (homepage && homepage.blogKicker) || 'CHECK OUT WHAT THE PROS HAVE TO SAY' %></h4>
		<h2 class="section-title"><%= (homepage && homepage.blogTitle) || 'SEE WHY WE’RE THE EXPERTS' %></h2>
		<div class="blogContent blogContent-wrapper">
			<div class="blogCards blogCards-wrapper col-sm-12">
				<div class="container blog-split justify-content-center">
					            <div class="featured-posts-wrapper">
							<% 
							  const posts = [];
							  for (let i = 1; i <= 3; i++) {
							    const pt = homepage && homepage[`blogFeat${i}Title`];
							    const pu = homepage && homepage[`blogFeat${i}Url`];
							    const pi = homepage && homepage[`blogFeat${i}Image`];
							    const pe = homepage && homepage[`blogFeat${i}Excerpt`];
							    if (pt && pu && pi) posts.push({ title: pt, url: pu, image: pi, excerpt: pe || '' });
							  }
							%>
							  <% posts.forEach(function(p){ %>
							    <a href="<%= p.url %>" class="feat-post col-sm-12 col-md-4 col-lg-4">
							    	<article class="post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
							    		<div class="post-thumbnail"><img width="800" height="600" src="<%= p.image %>" class="attachment-post-thumbnail size-post-thumbnail" alt="" decoding="async" /></div>
							    		<div class="entry-summary"><h6 class="entry-title"><%= p.title %></h6><% if (p.excerpt) { %><p><%= p.excerpt %></p><% } %></div>
							    	</article></a>
							  <% }) %>
						</div>
						            <aside class="featured-post-detail" aria-live="polite" aria-atomic="true" hidden>
              <div class="detail-card">
                <div class="detail-thumb">
                  <img src="" alt="" class="img-fluid" />
                </div>
                <div class="detail-body">
                <h3 class="detail-title"></h3>
                <p class="detail-excerpt clamp-4"></p>
                <div class="detail-actions">
                  <a class="btn btn-primary-dark detail-read" href="#" target="">Read full post</a>
                </div>
              </div>
            </div>
          </aside>
				</div>
			</div>
			<div class="text-center">
				<a href="/blog/index.html" class="btn btn-primary btn-lg">All Posts</a>
			</div>
		</div>
	</div>
</section>

<script>
  // Blog detail panel interaction: populate right-side panel from clicked card
  (function(){
    try {
      var split = document.querySelector('.blog-split');
      if (!split) return;
      var cards = split.querySelectorAll('.featured-posts-wrapper a.feat-post');
      var panel = split.querySelector('.featured-post-detail');
      if (!cards.length || !panel) return;

      var imgEl = panel.querySelector('.detail-thumb img');
      var titleEl = panel.querySelector('.detail-title');
      var excerptEl = panel.querySelector('.detail-excerpt');
      var linkEl = panel.querySelector('.detail-read');

      function slugifyTitle(s) {
        return String(s || '')
          .toLowerCase()
          .replace(/&/g, ' and ')
          .replace(/[^a-z0-9]+/g, '-')
          .replace(/^-+|-+$/g, '')
          .substring(0, 120);
      }

      function activateFromCard(card) {
        // Extract data
        var img = card.querySelector('.post-thumbnail img');
        var title = card.querySelector('.entry-title');
        var excerpt = card.querySelector('.entry-summary p');
        // Populate panel
        if (img && imgEl) {
          imgEl.src = img.getAttribute('src') || '';
          imgEl.alt = (title && title.textContent) ? title.textContent : '';
        }
        if (titleEl) titleEl.textContent = title ? title.textContent : '';
        if (excerptEl) {
          excerptEl.textContent = excerpt ? excerpt.textContent : '';
          excerptEl.classList.remove('clamp-4'); // Ensure expanded in panel
          var parent = excerptEl.parentElement;
          if (parent) parent.classList.remove('fade-after');
        }
        if (linkEl) {
          var slug = slugifyTitle(title ? title.textContent : '');
          linkEl.setAttribute('href', slug ? ('/blog/' + slug) : '/blog');
        }

        // Visual active state
        cards.forEach(function(c){ c.classList.remove('is-active'); });
        card.classList.add('is-active');
        // Reveal panel and switch layout
        panel.hidden = false;
        split.classList.add('show-detail');
      }

      // Bind click handlers
      cards.forEach(function(card){
        card.addEventListener('click', function(e){
          if (e.metaKey || e.ctrlKey) return; // allow open in new tab
          e.preventDefault();
          if (card.classList.contains('is-active')) {
            // Toggle off if clicking the active card
            card.classList.remove('is-active');
            panel.hidden = true;
            split.classList.remove('show-detail');
            return;
          }
          activateFromCard(card);
          // Scroll into view on small screens
          if (window.matchMedia('(max-width: 768px)').matches) {
            panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        });
      });

      // Close when clicking outside the blog-split area
      document.addEventListener('click', function(e){
        try {
          var within = split.contains(e.target);
          if (!within) {
            cards.forEach(function(c){ c.classList.remove('is-active'); });
            panel.hidden = true;
            split.classList.remove('show-detail');
          }
        } catch(_) {}
      });

      // Close on Escape key
      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape') {
          cards.forEach(function(c){ c.classList.remove('is-active'); });
          panel.hidden = true;
          split.classList.remove('show-detail');
        }
      });
    } catch(e) { /* no-op */ }
  })();
</script>

<section class="warranty banner bg-jade-geometric">
	<div class="container text-center">
		<div class="row"><div class="col-lg-8 justify-content-center mx-auto"><h2 class="section-title" style="color: white;"><%= (homepage && homepage.warrantyTitle) || 'OUR Warranty' %></h2><p><%= (homepage && homepage.warrantyBody) || 'Known across the U.S. for exceptional garage door services, Swim Studs is dedicated to providing great value through transparent estimates, expert advice, and amazing deals on every booking. Our services are backed by manufacturer warranties, including lifetime warranties on select components, ensuring you have peace of mind with every repair or installation.' %></p></div></div>
	</div>
</section>

<!-- Page-scoped styles: Review cards brand styling -->
<style>
  /* Only the individual review cards, not the whole section */
  #reviews .resi-review .resi-review--inner {
    background-color: var(--brand-red) !important;
    color: #fff !important;
    border-color: var(--brand-red) !important;
  }
  #reviews .resi-review .resi-review--inner .resi-review--stars,
  #reviews .resi-review .resi-review--inner .resi-review--content,
  #reviews .resi-review .resi-review--inner .resi-review--content p,
  #reviews .resi-review .resi-review--inner .resi-review--author,
  #reviews .resi-review .resi-review--inner h5,
  #reviews .resi-review .resi-review--inner p {
    color: #fff !important;
  }
  #reviews .resi-review .resi-review--inner a {
    color: #fff !important;
    border-color: rgba(255,255,255,0.5) !important;
  }
</style>

<section id="reviews" class="reviews reviews-wrapper">
	<div class="container">
		<section class="resi-reviews">
			<div class="container">
				<div class="resi-reviews--inner">
					<% 
					  const reviews = [];
					  for (let i = 1; i <= 3; i++) {
					    const text = homepage && homepage[`review${i}Text`];
					    const author = homepage && homepage[`review${i}Author`];
					    if (text && author) reviews.push({ text, author });
					  }
					%>
					<% reviews.forEach(function(r){ %>
					  <div class="resi-review"><div class="resi-review--inner"><div class="resi-review--stars">★★★★★</div><div class="resi-review--content check-overflow"><div class="resi-review--content--inner"><p><%= r.text %></p></div></div><div class="resi-review--meta"><h5 class="resi-review--author"><%= r.author %></h5></div></div></div>
					<% }); %>
				</div>
			</div>
		</section>
	</div>
</section>

<div class="container mb-5">
	<section class="get-started bg-garageup-primary bg-icon bg-icon-reverse bg-icon--light bg-icon-reverse--light">
		<div class="estimate-prompt">
			<h2 class="section-title"><%= (homepage && homepage.getStartedTitle) || 'Ready to get started?' %></h2>
			<p><%= (homepage && homepage.getStartedBody) || 'Contact us for a free onsite estimate within 24 hours.' %></p>
			<div class="btn-wrapper ">
				<a href="<%= (homepage && homepage.getStartedCtaUrl) || '/contact' %>" class="btn btn-primary-dark" target=""><%= (homepage && homepage.getStartedCtaLabel) || 'Contact Us' %></a>
			</div>
		</div>
	</section>
</div>

<script>
  (function () {
    try {
      var hero = document.querySelector('section.hero.hero-wrapper.overlay-jade');
      if (hero) {
        var bg = hero.getAttribute('data-hero-bg');
        if (bg) {
          hero.style.backgroundImage = 'url(' + JSON.stringify(bg) + ')';
          hero.style.backgroundRepeat = 'no-repeat';
          hero.style.backgroundSize = 'cover';
          hero.style.backgroundPosition = 'center';
        }
      }
    } catch (e) { /* no-op */ }
  })();
  </script>
<%- include('partials/footer') %>
